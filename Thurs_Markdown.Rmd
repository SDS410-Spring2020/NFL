---
title: "Q1 Analysis"
author: "Elaona Lemoto"
date: "2/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library (tidyverse)
```

```{r}

games<-read.csv("data/games_Smith.csv")
pbp<-read.csv("data/pbp_Smith.csv")
```


#Creation of 2 DFs (Thursday and Non Thursday)


```{r}

#join DF
data<-games %>% 
  left_join(pbp, by="GameKey")

#Creation of DF
thurs<-data %>% 
  filter(Game_Day=="Thursday") %>% 
  mutate()

non_thurs<-data%>% 
  filter(Game_Day!="Thursday")

```

#PLots
```{r}
#Game Days
ggplot(non_thurs, aes(Game_Day))+
  geom_histogram(stat="count")

ggplot(non_thurs, aes(as.factor(Turf)))+
  geom_bar()+
  coord_flip()

ggplot(non_thurs, aes(Temperature))+
  geom_histogram()
ggplot(thurs, aes(Temperature))+
  geom_histogram()

ggplot(non_thurs, aes(TimeZone))+
  geom_histogram(stat="count")+
  coord_flip()
#Clean up time zone
#Create a binary thursday column 


#Count
count(data, Season)
count (data, Week)
```

```{r}
data <- data %>% 
  #might want to look at this in terms of game excitement
  mutate(is_thurs = ifelse(Game_Day == "Thursday", 1, 0))

data_2019<-data %>% 
  filter(Season==2019)

```

```{r}

#Clean strings

pbp$PlayDescription<-str_to_lower(pbp$PlayDescription)

#Playing around with counts
data_2019<-data_2019 %>% 
  mutate(PlayDescription=as.character(PlayDescription))
kicks<-str_count(data_2019$PlayDescription,"kick")
sum(kicks)
mean(kicks)

tackle<-str_count(pbp$PlayDescription,"tackle")
sum(tackle)
mean(tackle)

pass<-str_which(pbp$PlayDescription,"pass")
sum(pass)
mean(pass)

#String counts


words <- data.frame(Var2 = c("pass", "kick", "tackle", "penalty", "punts", "fumbles", "fumble", "false start", "sacked", "pass short"),bad_plays=c("pass incomplete", "interception"),
                     stringsAsFactors = FALSE)


sapply(words$Var2,function(x){length(str_which(pbp$PlayDescription, pattern = x))})



```

